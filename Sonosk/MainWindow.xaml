<Window x:Class="Sonosk.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Sonosk.ViewModel"
        xmlns:wpf="clr-namespace:Sonosk.Wpf"
        mc:Ignorable="d"
        WindowStyle="None"
        ResizeMode="NoResize"
        WindowStartupLocation="Manual"
        Title="MainWindow"
        Height="Auto"
        Width="500"
        d:DataContext="{d:DesignInstance Type=local:MainViewModel, IsDesignTimeCreatable=True}"
        Background="Transparent"
        AllowsTransparency="True">

    <!-- Resources -->
    <Window.Resources>
        <!--<LinearGradientBrush x:Key="MidnightGlassSoftBrush"
                             StartPoint="0,0"
                             EndPoint="0,1">
            --><!-- Bright, soft top --><!--
            <GradientStop Color="#FFDDE6FF"
                          Offset="0.0" />
            --><!-- very pale blue-lavender --><!--
            <GradientStop Color="#FFBBCDFF"
                          Offset="0.25" />
            --><!-- soft pastel periwinkle -->

            <!-- Vibrant mid glow --><!--
            <GradientStop Color="#FF7F7FFF"
                          Offset="0.45" />
            --><!-- saturated bright purple-blue --><!--
            <GradientStop Color="#FF5F5FFF"
                          Offset="0.6" />
            --><!-- deeper, vivid violet -->

            <!-- Bold lower fade --><!--
            <GradientStop Color="#FF3F3FAF"
                          Offset="0.8" />
            --><!-- deep saturated purple --><!--
            <GradientStop Color="#FF1A1A5A"
                          Offset="1.0" />
            --><!-- rich dark midnight blue --><!--
        </LinearGradientBrush>-->


        <LinearGradientBrush x:Key="AmberGlassBrush"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Color="#FFFFF0A0"
                          Offset="0.0" />
            <GradientStop Color="#FFFFCC70"
                          Offset="0.25" />
            <GradientStop Color="#FFFFA040"
                          Offset="0.45" />
            <GradientStop Color="#FFFF7A20"
                          Offset="0.6" />
            <GradientStop Color="#FFCC5A10"
                          Offset="0.8" />
            <GradientStop Color="#FF442000"
                          Offset="1.0" />
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="AmberGlassSoftBrush"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <!-- Soft warm top -->
            <GradientStop Color="#FFFFF6D5"
                          Offset="0.0" />
            <GradientStop Color="#FFFFE4B8"
                          Offset="0.25" />

            <!-- Gentle core warmth -->
            <GradientStop Color="#FFFFCA8A"
                          Offset="0.45" />
            <GradientStop Color="#FFFFB066"
                          Offset="0.6" />

            <!-- Mild lower fade -->
            <GradientStop Color="#FFE08C50"
                          Offset="0.8" />
            <GradientStop Color="#FF6A3C1A"
                          Offset="1.0" />
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="FancyOrangeVerticalBrush"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Color="#FFFFF6C0"
                          Offset="0.0" />
            <GradientStop Color="#FFFFD080"
                          Offset="0.15" />
            <GradientStop Color="#FFFFA000"
                          Offset="0.35" />
            <GradientStop Color="#FFFF7A00"
                          Offset="0.55" />
            <GradientStop Color="#FFCC5A00"
                          Offset="0.7" />
            <GradientStop Color="#FF552000"
                          Offset="1.0" />
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="GrayGlassSoftBrush"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <!-- Soft light top -->
            <GradientStop Color="#FFF6F6F6"
                          Offset="0.0" />
            <GradientStop Color="#FFE4E4E4"
                          Offset="0.25" />

            <!-- Gentle mid gray -->
            <GradientStop Color="#FFCACACA"
                          Offset="0.45" />
            <GradientStop Color="#FFB0B0B0"
                          Offset="0.6" />

            <!-- Mild lower fade -->
            <GradientStop Color="#FF8C8C8C"
                          Offset="0.8" />
            <GradientStop Color="#FF3C3C3C"
                          Offset="1.0" />
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="CharcoalGlassBrush"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Color="#FF383838"
                          Offset="0.0" />
            <GradientStop Color="#FF2A2A2A"
                          Offset="0.2" />
            <GradientStop Color="#FF202020"
                          Offset="0.5" />
            <GradientStop Color="#FF141414"
                          Offset="0.85" />
            <GradientStop Color="#FF0E0E0E"
                          Offset="1.0" />
        </LinearGradientBrush>


        <!-- Gradient brush for the border -->
        <LinearGradientBrush x:Key="BorderGradient"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Color="#FF1C1C1C"
                          Offset="0" />
            <GradientStop Color="#FF3A3A3A"
                          Offset="1" />
        </LinearGradientBrush>

        <!-- Light text style -->
        <Style x:Key="LightText"
               TargetType="TextBlock">
            <Setter Property="Foreground"
                    Value="#E0E0E0" />
            <Setter Property="FontSize"
                    Value="16" />
            <Setter Property="FontFamily"
                    Value="Calibri" />
        </Style>

        <!-- ProgressBar style with vertical gradient -->
        <Style TargetType="ProgressBar"
               x:Key="GradientProgressBar">
            <Setter Property="Foreground"
                    Value="{StaticResource AmberGlassSoftBrush}">
            </Setter>
            <Setter Property="Background"
                    Value="{StaticResource CharcoalGlassBrush}" />
            <Setter Property="Height"
                    Value="20" />
            <Setter Property="BorderThickness"
                    Value="0" />
            <Setter Property="BorderBrush"
                    Value="Black" />
        </Style>
        <!-- ProgressBar style with vertical gradient -->
        <Style TargetType="ProgressBar"
               x:Key="SelectedGradientProgressBar">
            <Setter Property="Foreground"
                    Value="{StaticResource FancyOrangeVerticalBrush}">
            </Setter>
            <Setter Property="Background"
                    Value="{StaticResource CharcoalGlassBrush}" />
            <Setter Property="Height"
                    Value="20" />
            <Setter Property="BorderThickness"
                    Value="0" />
            <Setter Property="BorderBrush"
                    Value="Black" />
        </Style>


        <wpf:SelectedStyleMultiConverter x:Key="ProgressBarStyleSelector"
                                           NormalStyle="{StaticResource GradientProgressBar}"
                                           SelectedStyle="{StaticResource SelectedGradientProgressBar}" />
    </Window.Resources>

    <!-- Main border with drop shadow -->
    <Border CornerRadius="10"
            Padding="10"
            Margin="16"
            Background="{StaticResource BorderGradient}"
            SnapsToDevicePixels="True"
            x:Name="LayoutRoot"
            VerticalAlignment="Bottom">

        <Border.Effect>
            <DropShadowEffect Color="Black"
                              BlurRadius="20"
                              ShadowDepth="0"
                              Opacity="0.7" />
        </Border.Effect>

        <StackPanel>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Horizontal">
                    <TextBlock Style="{StaticResource LightText}"
                               FontFamily="Segoe UI"
                               FontSize="24"
                               Margin="0,0,0,10"
                               Text="🎶SONOSK" />
                    <TextBlock Style="{StaticResource LightText}"
                               Foreground="#555"
                               FontFamily="Segoe UI"
                               FontSize="20"
                               Margin="0,0,0,11"
                               Text="ontroller"
                               VerticalAlignment="Bottom" />
                </StackPanel>

                <Image x:Name="refresh"
                       Width="24"
                       Height="24"
                       VerticalAlignment="Top"
                       Grid.Column="1"
                       Stretch="Uniform"
                       RenderTransformOrigin="0.5,0.5"
                       Source="/Resources/refresh.png" />

            </Grid>

            <ItemsControl ItemsSource="{Binding Groups}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border BorderBrush="#444"
                                CornerRadius="2"
                                BorderThickness="1"
                                Margin="0,0,0,20"
                                Padding="10">
                            <StackPanel >
                                <StackPanel.InputBindings>
                                    <MouseBinding MouseAction="LeftClick"
                                                  Command="{Binding DataContext.SelectDeviceCommand,
                                        RelativeSource={RelativeSource AncestorType=Window}}"
                                                  CommandParameter="{Binding}" />
                                </StackPanel.InputBindings>
                                <!-- Room name and volume text -->
                                <TextBlock Style="{StaticResource LightText}"
                                           FontFamily="Segoe UI Semibold"
                                           FontSize="18">
                                <Run Text="{Binding GroupName}"
                                     d:Text="GroupName" />
                                </TextBlock>

                                <Grid Margin="0,5,0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <!-- Progress bar -->
                                    <Border BorderThickness="1"
                                            Margin="0,0,5,0" 
                                            BorderBrush="Black">

                                        <ProgressBar wpf:SliderExtensions.EnableMouseWheel="True"
                                                     wpf:SliderExtensions.EnableDragging="True"
                                                     SmallChange="0.005"
                                                     Value="{Binding Volume, Mode=TwoWay}"
                                                     d:Value="50"
                                                     Maximum="100">
                                            <ProgressBar.Style>
                                                <MultiBinding Converter="{StaticResource ProgressBarStyleSelector}">
                                                    <!-- Current item -->
                                                    <Binding />
                                                    <!-- SelectedViewModel from Window DataContext -->
                                                    <Binding Path="DataContext.SelectedViewModel"
                                                             RelativeSource="{RelativeSource AncestorType=Window}" />
                                                </MultiBinding>
                                            </ProgressBar.Style>
                                        </ProgressBar>
                                    </Border>


                                    <TextBlock Style="{StaticResource LightText}"
                                               Grid.Column="2"
                                               Width="40"
                                               TextAlignment="Right">
                                    <Run Text="{Binding Volume, StringFormat={}{0}%}"
                                         d:Text="100%" />
                                    </TextBlock>
                                </Grid>

                                <ItemsControl ItemsSource="{Binding Devices}">
                                    <ItemsControl.Style>
                                        <Style TargetType="ItemsControl">
                                            <Setter Property="Visibility"
                                                    Value="Visible" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Devices.Count}"
                                                             Value="1">
                                                    <Setter Property="Visibility"
                                                            Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ItemsControl.Style>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Grid Margin="0,0,0,5">
                                                <Grid.InputBindings>
                                                    <MouseBinding MouseAction="LeftClick"
                                                                  Command="{Binding DataContext.SelectDeviceCommand,
                                                                             RelativeSource={RelativeSource AncestorType=Window}}"
                                                                  CommandParameter="{Binding}" />
                                                </Grid.InputBindings>
                                                
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>

                                                <TextBlock Style="{StaticResource LightText}"
                                                           Grid.Column="0"
                                                           MinWidth="80"
                                                           TextAlignment="Left">
                                                    <Run Text="{Binding Name}"
                                                         d:Text="Name"
                                                         FontFamily="Segoe UI" />
                                                </TextBlock>

                                                <Border BorderThickness="1"
                                                        Grid.Column="1"
                                                        Margin="5,0,5,0"
                                                        BorderBrush="Black">
                                                    <!-- Progress bar -->
                                                    <ProgressBar wpf:SliderExtensions.EnableMouseWheel="True"
                                                                 wpf:SliderExtensions.EnableDragging="True"
                                                                 SmallChange="0.005"
                                                                 Value="{Binding Volume, Mode=TwoWay}"
                                                                 d:Value="50"
                                                                 Maximum="100">
                                                        <ProgressBar.Style>
                                                            <MultiBinding Converter="{StaticResource ProgressBarStyleSelector}">
                                                                <!-- Current item -->
                                                                <Binding />
                                                                <!-- SelectedViewModel from Window DataContext -->
                                                                <Binding Path="DataContext.SelectedViewModel"
                                                                         RelativeSource="{RelativeSource AncestorType=Window}" />
                                                            </MultiBinding>
                                                        </ProgressBar.Style>
                                                    </ProgressBar>


                                                </Border>

                                                
                                                <TextBlock Style="{StaticResource LightText}"
                                                           Grid.Column="3"
                                                           Width="40"
                                                           TextAlignment="Right">
                                                <Run Text="{Binding Volume, StringFormat={}{0}%}"
                                                     d:Text="9%" />
                                                </TextBlock>
                                            </Grid>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </StackPanel>

    </Border>
</Window>
